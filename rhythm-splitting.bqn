# Music notation: break rhythmic values into correctly tied notes

# naive: no syncopation or dotted notes
# top-down, recursive
# probably a left-to-right algorithm will be better in the end

Match â† {ğ•©âŠ”Ëœ/ğ•©â‹âŒ¾(+`)ğ•¨}   # match tied (split) durations to unsplit durations
# e.g. 1â€¿3â€¿6â€¿1â€¿1 Match 1â€¿2â€¿1â€¿4â€¿2â€¿1â€¿1
# assumes:
#   - âˆ§Â´ğ•©>0
#   - ğ•©â‰¡â—‹(+Â´)ğ•¨
#   - âˆ§Â´ğ•¨âˆŠâ—‹(+`)ğ•©
# ensures:
#   - ğ•©â‰¡âˆ¾ ğ•¨ğ•Šğ•©
#   - ğ•¨â‰¡+Â´Â¨ ğ•¨ğ•Šğ•©

Break â† {
  "total duration should be power of 2" ! âŒŠâŠ¸=2â‹†â¼+Â´ğ•©
  ğ•© Match { âŸ¨aâŸ©:âŸ¨aâŸ© ;
    lâ†ğ•Šnâˆ¾Ëœğ•©(</âŠ£)n â†(Â¯1âŠ‘ğ•©)Ã·2
    râ†ğ•ŠâŒ¾(-âŸœn)ğ•©(>/âŠ£)n
    lâˆ¾r }âŒ¾(+`) ğ•©
}

lâ†16Ã· Break âŸ¨2,4,1,1,2,2,4,5,3,8âŸ©

# LilyPond notation
Splice â† {aâ€¿zğ•Šğ•©:(-â‰ z)â†“âˆ¾{aâˆ¾ğ•©âˆ¾z}Â¨ğ•©}
â€¢Out ""â€¿" "Splice{"a"â€¿"~ "Spliceâ€¢FmtÂ¨ğ•©}Â¨ l
